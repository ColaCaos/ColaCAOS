<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>22&nbsp; Predicitibilidad de datos meteorológicos – Estudio del Caos en sistemas físicos y su relación con la predicción meteorológica</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../03-meteorologia/predicciones.html" rel="next">
<link href="../03-meteorologia/meteorologia.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-4e4b9be472244950dedd20f9d2c0893e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../03-meteorologia/meteorologia.html">La Meteorología y el Caos</a></li><li class="breadcrumb-item"><a href="../03-meteorologia/calculolyapunov.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Predicitibilidad de datos meteorológicos</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Estudio del Caos en sistemas físicos y su relación con la predicción meteorológica</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introducción</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">ColaCaos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../objetivos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Objetivos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resultados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Resultados</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">El Caos a través de la Función Logística</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-logistica/mapa-logistico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">El Mapa Logístico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-logistica/cobweb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Diagrama de telaraña</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-logistica/puntos-fijos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Puntos fijos de una función</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-logistica/analisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Estudio formal del mapa logístico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-logistica/generico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Término genérico del mapa logístico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-logistica/estable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Estabilidad del mapa logístico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-logistica/bifurcaciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Primera bifurcación</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-logistica/simulacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Bifurcaciones sucesivas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-logistica/Caos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Caos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-logistica/lyapunov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Efecto mariposa</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-logistica/criterio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">El exponente de Lyapunov y el caos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">El Caos en vivo: El péndulo doble</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-pendulo-doble/doble.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">El Péndulo Doble</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-pendulo-doble/simulaciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Sensibilidad a las condiciones iniciales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-pendulo-doble/fractal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Mapa de Fases</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-pendulo-doble/bifurcacionesPendulo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Bifurcaciones</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-pendulo-doble/estadisticas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Qué podemos predecir</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-pendulo-doble/experimentos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Experimentos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">La Meteorología y el Caos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-meteorologia/meteorologia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Meteorología y Caos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-meteorologia/calculolyapunov.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Predicitibilidad de datos meteorológicos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-meteorologia/predicciones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Caos en las predicciones meteorológicas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-meteorologia/Aemet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Entrevista con expertos de la AEMET</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">El Clima y el Caos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-clima/introclima.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Clima</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-clima/atractor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Atractores</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-clima/rapido.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Cambios Climáticos Rápidos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-clima/evaluacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Evaluación de las predicciones climáticas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-clima/caosclima.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Conclusiones sobre la predictibilidad del clima</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Mi sistema caótico</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-experimentos/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-experimentos/funcionamientoCaotico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Simulación y funcionamiento caótico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-experimentos/test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">test</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#explicación-de-tau-y-m" id="toc-explicación-de-tau-y-m" class="nav-link active" data-scroll-target="#explicación-de-tau-y-m"><span class="header-section-number">22.1</span> Explicación de <span class="math inline">\(\tau\)</span> y <span class="math inline">\(m\)</span></a></li>
  <li><a href="#exponente-de-lyapunov-para-la-serie-de-valores-de-temperatura" id="toc-exponente-de-lyapunov-para-la-serie-de-valores-de-temperatura" class="nav-link" data-scroll-target="#exponente-de-lyapunov-para-la-serie-de-valores-de-temperatura"><span class="header-section-number">22.2</span> Exponente de Lyapunov para la serie de valores de temperatura</a></li>
  <li><a href="#exponente-de-lyapunov-para-la-serie-de-velocidad-del-viento" id="toc-exponente-de-lyapunov-para-la-serie-de-velocidad-del-viento" class="nav-link" data-scroll-target="#exponente-de-lyapunov-para-la-serie-de-velocidad-del-viento"><span class="header-section-number">22.3</span> Exponente de Lyapunov para la serie de velocidad del viento</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../03-meteorologia/meteorologia.html">La Meteorología y el Caos</a></li><li class="breadcrumb-item"><a href="../03-meteorologia/calculolyapunov.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Predicitibilidad de datos meteorológicos</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Predicitibilidad de datos meteorológicos</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>El primer paso a la hora de estudiar el caos en el tiempo meteorológico es disponer de datos históricos de los principales parámetros del tiempo. Existe una excelente web llamada <a href="https://open-meteo.com/en/docs">OpenMeteo</a> que proporciona datos históricos de observaciones y predicciones para cualquier localidad, y que además lo hace de forma gratuita en:</p>
<p>https://open-meteo.com/en/docs</p>
<p>Poniéndome manos a la obra, he descargado los datos históricos de Galapagar desde el año 1950. La serie histórica que devuelve la página web tiene este formato:</p>
<p>latitude,longitude,elevation,utc_offset_seconds,timezone,timezone_abbreviation<br>
40.597538,-4.0735474,885.0,7200,Europe/Berlin,GMT+2</p>
<p>time,temperature_2m_mean (°C),precipitation_sum (mm),wind_speed_10m_mean (km/h)<br>
1950-06-07,20.7,0.50,13.1<br>
1950-06-08,18.4,2.30,14.4<br>
1950-06-09,18.6,3.10,10.0<br>
1950-06-10,18.6,3.90,7.8<br>
1950-06-11,18.8,0.50,11.2<br>
1950-06-12,17.0,0.00,9.0<br>
1950-06-13,18.9,0.20,7.2<br>
1950-06-14,21.1,0.00,8.0<br>
1950-06-15,20.2,0.00,12.8</p>
<p>En segundo lugar tenemos que saber qué hacer con estos datos. Después de varias búsquedas en ChatGPT y google encontré un artículo sencillo sobre cómo calcular el exponente de Lyapunov en datos meteorologicos.</p>
<blockquote class="blockquote">
<p><strong>Referencia completa:</strong> Özgür E. &amp; Yılmaz M. U. (2022). Using Chaos Theory to Determine Average Prediction Times of Different Meteorological Variables: A Case Study in Sivas. <em>Int. J. Adv. Eng. Pure Sci.</em> 34(1):101–106.</p>
</blockquote>
<p>El artículo investiga cuánto tiempo, en promedio, pueden predecirse fiablemente tres series diarias (temperatura, velocidad del viento y humedad relativa desde el año 2006 hasta el 2010 para la estación de Sivas en Turquía) usando teoría del caos. Le pasé este artículo a chatGPT y le pedí que reprodujese los cálculos para mis datos de Galapagar. Una de las preguntas que me lanzó de vuelta chatGPT es que si quería usar los valores de los parámetros <span class="math inline">\(m\)</span> y <span class="math inline">\(\tau\)</span> que usaban en el estudio de la estación turca. Pedí de vuelta a ChatGPT que eran estos valores, pues al parecer jugaban un papel crítico a la hora de estimar el valor del exponente de Lyapunov.</p>
<section id="explicación-de-tau-y-m" class="level2" data-number="22.1">
<h2 data-number="22.1" class="anchored" data-anchor-id="explicación-de-tau-y-m"><span class="header-section-number">22.1</span> Explicación de <span class="math inline">\(\tau\)</span> y <span class="math inline">\(m\)</span></h2>
<p><strong>Retraso <span class="math inline">\(\tau\)</span></strong><br>
El retraso <span class="math inline">\(\tau\)</span> indica cuántos pasos (días) “saltamos” entre cada coordenada al calcular el exponente de Lyapunov. En lugar de usar solo <span class="math inline">\(x(t)\)</span>, usamos<br>
<span class="math display">\[
\bigl(x(t),\,x(t+\tau),\,x(t+2\tau),\dots\bigr).
\]</span><br>
- Si <span class="math inline">\(\tau\)</span> es muy pequeño, <span class="math inline">\(x(t)\)</span> y <span class="math inline">\(x(t+\tau)\)</span> están muy correlacionados y aportan información casi redundante.<br>
- Si <span class="math inline">\(\tau\)</span> es muy grande, <span class="math inline">\(x(t)\)</span> y <span class="math inline">\(x(t+\tau)\)</span> pueden ser casi independientes y perder la conexión dinámica.</p>
<p>El artículo turco revela que es óptimo trabajar con un valor de <span class="math inline">\(\tau\)</span> igual a 3 para la temperatura. Es decir, analizaremos el exponente de Lyapunov de la serie que nos da la temperatura en Galapagar cada tres días.</p>
<p><strong>Dimensión de embedding <span class="math inline">\(m\)</span></strong><br>
La dimensión <span class="math inline">\(m\)</span> es el número de valores escalonados que usamos para describir el estado del sistema:<br>
<span class="math display">\[
\mathbf X(t)=\bigl(x(t),\,x(t+\tau),\,x(t+2\tau),\dots,x(t+(m-1)\tau)\bigr).
\]</span></p>
<p>Es decir, el estado del sistema en un día, no es solamente el valor de la temperatura ese día, sino el valor de ese día más varios días anteriores. Pues bien, lo que necesitamos saber es cual es la dimensión óptima del estado del sistema. Si por ejemplo solo cojo un día, habrá muchos días que sean similares ya que habrá muchos casos en los que coincida la temperatura media para ese día. Sin embargo esto es engañoso, ya que no se tiene en cuenta el estado pasado del sistema. No es lo mismo estar en un día a 15 grados de temperatura media después de haber pasado una ola de calor, que estár a 15 grados después de varios días de ola de frío. De acuerdo al artículo turco un valor de <span class="math inline">\(m=12\)</span> es óptimo.</p>
<p>Con estos valores de <span class="math inline">\(\tau\)</span> y <span class="math inline">\(m\)</span> le pedí a ChatGPT que me calculase el exponente de Lyapunov de la serie de temperaturas de Galapagar. ChatGPT usa en este caso el mismo algoritmo que para el cálculo del exponente de Laypunov de las simulaciones del péndulo doble. Se trata de un algoritmo bastante complicado cuya comprensión se me escapa. Hay que tener en cuenta que todos estos cálculos los realizo a con el modelo 04-mini-high, que tiene una capacidad matemática muy superior a la esperada de un alumno de bachillerato, y que además es capaz de hacer los cálculos en un entorno interno de Python, y de plotear resultados.</p>
</section>
<section id="exponente-de-lyapunov-para-la-serie-de-valores-de-temperatura" class="level2" data-number="22.2">
<h2 data-number="22.2" class="anchored" data-anchor-id="exponente-de-lyapunov-para-la-serie-de-valores-de-temperatura"><span class="header-section-number">22.2</span> Exponente de Lyapunov para la serie de valores de temperatura</h2>
<p>A continuación muestro todos los valores de temperatura que hemos sacado de la web open-meteo. Obviamente en la serie original vemos que hay un componente estacional muy fuerte. Le pedía ChatGPT que estimase la variación estacional y que la quitase de los datos, dándome la gráfica de temperatura desestacionalizada. En ella se ven las variaciones de temperatura como algo más aleatorio ya que hemos quitado las componentes estacionales. No obstante se ve una ligera subida de temperaturas desde el año 1950 hasta el presente, coincidente con el aumento de temperaturas observado a nivel global en la Tierra.</p>
<div id="2e487ebc" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="calculolyapunov_files/figure-html/cell-2-output-1.png" width="565" height="372" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="calculolyapunov_files/figure-html/cell-2-output-2.png" width="565" height="372" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Como curiosidad, le pedía a ChatGPT que hiciese una regresión no lineal de orden 2 para ver como ha ido evolucionando la temperatura media en Galapagar desde 1950.</p>
<div id="1f78b926" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="calculolyapunov_files/figure-html/cell-3-output-1.png" width="565" height="372" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>La temperatura media desestacionalizada ha subido desde 1950 hasta 2025 aproximadamente <span class="math inline">\(\Delta y = y(2025) - y(1950) \approx 2.23\ ^\circ\mathrm{C}\)</span>.<br>
La tasa media de incremento es <span class="math inline">\(\displaystyle \frac{2.23\ ^\circ\mathrm{C}}{75\ \mathrm{años}} \approx 0.030\ ^\circ\mathrm{C}/\mathrm{año}\)</span> (aproximadamente <span class="math inline">\(0.3\ ^\circ\mathrm{C}/\mathrm{década}\)</span>). ¡Casi nada!!!!!</p>
<p>Volvamos al tajo. Ahora le pido a ChatGPT que me haga el cálculo del exponente de Lyapunov para estos datos de temperatura, usando el mismo procedimiento y parámetros que en el artículo de la estación de Turquía. El exponente de Lyapunov máximo calculado para la temperatura desestacionalizada es<br>
<span class="math display">\[
\lambda_{\max} \approx 0.219\ \mathrm{día}^{-1}.
\]</span></p>
<section id="horizonte-de-predictibilidad" class="level3" data-number="22.2.1">
<h3 data-number="22.2.1" class="anchored" data-anchor-id="horizonte-de-predictibilidad"><span class="header-section-number">22.2.1</span> Horizonte de predictibilidad</h3>
<p>Veamos en qué se traduce esta exponente de Lyapunov. Al ser positivo sabemos que indica que estamos ante un sistema caótico, y que los errores se amplificarán con el tiempo. Veamos cuando multiplicamos por 10 un error inicial de 0.1 grados Centígrados:</p>
<p><span class="math display">\[
T = \frac{1}{\lambda_{\max}}\ln\Bigl(\frac{L}{\varepsilon}\Bigr)
  = \frac{1}{0.219}\ln(10) \approx 10.5\ \mathrm{días}.
\]</span></p>
</section>
<section id="amplificación-de-un-error-inicial-de-0.1-c-tras-15-días" class="level3" data-number="22.2.2">
<h3 data-number="22.2.2" class="anchored" data-anchor-id="amplificación-de-un-error-inicial-de-0.1-c-tras-15-días"><span class="header-section-number">22.2.2</span> Amplificación de un error inicial de 0.1 °C tras 15 días</h3>
<p>Y ahora veamos de formá gráfica cómo se va amplificando el error inicial de 0.1 grados tras quince días.</p>
<div id="37761664" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="calculolyapunov_files/figure-html/cell-4-output-1.png" width="565" height="372" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Estos valores refuerzan las hipótesis inciales con las que habíamos especulado. Pasadas dos semanas es muy difícil tener estimaciones precisas del tiempo meteorológico.</p>
</section>
</section>
<section id="exponente-de-lyapunov-para-la-serie-de-velocidad-del-viento" class="level2" data-number="22.3">
<h2 data-number="22.3" class="anchored" data-anchor-id="exponente-de-lyapunov-para-la-serie-de-velocidad-del-viento"><span class="header-section-number">22.3</span> Exponente de Lyapunov para la serie de velocidad del viento</h2>
<p>A continuación cargamos y desestacionalizamos los datos de velocidad del viento (1950–presente), mostramos la serie original y la desestacionalizada:</p>
<div id="ef169147" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="calculolyapunov_files/figure-html/cell-5-output-1.png" width="565" height="372" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>En este caso no hay gran diferencia entre la componente desestacionalizada y sin desestacionalizar.</p>
<section id="exponente-de-lyapunov" class="level3" data-number="22.3.1">
<h3 data-number="22.3.1" class="anchored" data-anchor-id="exponente-de-lyapunov"><span class="header-section-number">22.3.1</span> Exponente de Lyapunov</h3>
<p>El exponente de Lyapunov máximo calculado para la serie de viento desestacionalizada (usando Wolf, <span class="math inline">\(m=12\)</span>, <span class="math inline">\(\tau=3\)</span>) es<br>
<span class="math display">\[
\lambda_{\max} \approx 0.414\ \mathrm{día}^{-1}.
\]</span></p>
</section>
<section id="horizonte-de-predictibilidad-1" class="level3" data-number="22.3.2">
<h3 data-number="22.3.2" class="anchored" data-anchor-id="horizonte-de-predictibilidad-1"><span class="header-section-number">22.3.2</span> Horizonte de predictibilidad</h3>
<p>Para un error inicial <span class="math inline">\(\varepsilon = 1\ \mathrm{km/h}\)</span> y un factor de crecimiento 10× (<span class="math inline">\(L/\varepsilon=10\)</span>):<br>
<span class="math display">\[
T = \frac{1}{\lambda_{\max}}\ln\Bigl(\frac{L}{\varepsilon}\Bigr)
  = \frac{1}{0.414}\ln(10)\approx5.6\ \mathrm{días}.
\]</span></p>
</section>
<section id="amplificación-de-un-error-inicial-de-1-kmh-tras-15-días" class="level3" data-number="22.3.3">
<h3 data-number="22.3.3" class="anchored" data-anchor-id="amplificación-de-un-error-inicial-de-1-kmh-tras-15-días"><span class="header-section-number">22.3.3</span> Amplificación de un error inicial de 1 km/h tras 15 días</h3>
<div id="96f9d258" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="calculolyapunov_files/figure-html/cell-6-output-1.png" width="565" height="372" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-lyapunov" class="level3" data-number="22.3.4">
<h3 data-number="22.3.4" class="anchored" data-anchor-id="sec-lyapunov"><span class="header-section-number">22.3.4</span> Comparación de la predictibilidad: viento vs temperatura</h3>
<p>En el caso de la temperatura desestacionalizada, obtuvimos un exponente de Lyapunov<br>
<span class="math display">\[
\lambda_{\max}^{\rm temp}\approx0.219\ \mathrm{día}^{-1},
\]</span><br>
lo que da un horizonte de predictibilidad de<br>
<span class="math display">\[
T_{\rm temp}
=\frac{1}{0.219}\ln(10)\approx10.5\ \mathrm{días}.
\]</span></p>
<p>Para la velocidad del viento desestacionalizada hallamos<br>
<span class="math display">\[
\lambda_{\max}^{\rm viento}\approx0.414\ \mathrm{día}^{-1},
\]</span><br>
y por tanto<br>
<span class="math display">\[
T_{\rm viento}
=\frac{1}{0.414}\ln(10)\approx5.6\ \mathrm{días}.
\]</span></p>
<p>Observamos que<br>
<span class="math display">\[
T_{\rm viento}\approx\frac{1}{2}\,T_{\rm temp}.
\]</span><br>
Esto significa que <strong>la serie de viento es más caótica</strong>: su exponente de Lyapunov es casi el doble, y los errores iniciales se amplifican mucho más rápido.</p>
<p>Varias razones explican esta diferencia:</p>
<ul>
<li><strong>Variabilidad a corto plazo</strong>: la velocidad del viento está dominada por fenómenos de escala reducida (frentes, turbulencia, ráfagas) que inducen cambios bruscos.</li>
<li><strong>Forzamientos estacionales débiles</strong>: el ciclo anual aporta poca oscilación comparado con la temperatura, por lo que el viento muestra un comportamiento intrínsecamente más errático.</li>
</ul>
<ol type="1">
<li><p><strong>¿Qué es un “forzamiento estacional”?</strong><br>
Es la variación periódica y predecible que se repite cada año, debida al cambio de estación (más sol y calor en verano, menos en invierno).</p></li>
<li><p><strong>Temperatura vs.&nbsp;viento</strong></p>
<ul>
<li><strong>Temperatura</strong>: el rango típico entre verano e invierno puede ser de <span class="math inline">\(\pm10\ ^\circ\mathrm{C}\)</span> o más. Es decir, el ciclo anual supone una parte muy importante de la variabilidad total.<br>
</li>
<li><strong>Viento</strong>: la velocidad media cambia solo unos <span class="math inline">\(\pm2\ \mathrm{km/h}\)</span> a lo largo del año. Esa “señal” anual es pequeña comparada con las oscilaciones diarias o las rachas impredecibles.</li>
</ul></li>
<li><p><strong>Efecto al desestacionalizar</strong></p>
<ul>
<li>Al quitar la estacionalidad de la temperatura, reducimos mucho la amplitud de la serie y “dejamos ver” las fluctuaciones reales.<br>
</li>
<li>Al hacer lo mismo con el viento, casi no cambiamos nada: la mayor parte de la variabilidad ya venía de eventos de corto plazo, no del ciclo anual.</li>
</ul></li>
</ol>
<ul>
<li><strong>Implicaciones prácticas</strong>: mientras que las predicciones de temperatura pueden ser útiles hasta unos 10 días, las de viento pierden precisión ya a los 5–6 días, reflejo de su carácter más caótico.</li>
</ul>



</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../03-meteorologia/meteorologia.html" class="pagination-link" aria-label="Meteorología y Caos">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Meteorología y Caos</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../03-meteorologia/predicciones.html" class="pagination-link" aria-label="Caos en las predicciones meteorológicas">
        <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Caos en las predicciones meteorológicas</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>