---
format:
  html:
    math: katex
execute:
  enabled: true
  echo: false
---

# Simulación y funcionamiento caótico

Una vez construida la rueda en el simulador y después de haber comprobado que todo funcionaba correctamente, empecé con las simulaciones del sistema.

Primero corrí la simulación cinco veces durante 180 segundos cada vez y en todas ellas establecí exactamente las mismas condiciones iniciales para todos los parámetros. Estos parámetros son teóricamente idénticos todas las veces que he ejecutado la simulación ya que el programa me permite hacer varias copias de un estado del sistema para después poder correr la simulación varias veces con las mismas exactas condiciones iniciales.

En cada una de las simulaciones usé una opción de Algodoo para tener grabados los datos de velocidad angular instantánea de la rueda, de la posición x (en el eje horizontal) del centro de masas de las canicas a lo largo del tiempo y de la posición en y (en el eje vertical) del centro de masas de las canicas.

En este gráfico se muestra la evolución de la velocidad angular de las cinco simulaciones todas empezando desde el mismo punto cada una representada con un color distinto.

![180 segundos de simulación](output (13).png)

Se puede ver como todas empiezan con una velocidad angular de aproximadamente 3 rad/s y rápidamente debido al rozamiento especialmente con el agua que va cayendo todas se frenan al mismo tiempo hasta alrededor de los 0.5 rad/s. Hasta este momento sobre el segundo 3 todas las simulaciones van juntas y solo se distingue una línea. Es justo a partir de este momento cuando las simulaciones empiezan a separarse y en solo unos pocos segundos ya va cada una por su lado, e incluso la simulación número 2 pasa a tener velocidad angular negativa, lo que significa que la rueda ha cambiado su sentido de giro. Esto lo hace aun habiendo empezado con una velocidad angular de 3 rad/s y no desde el reposo. Esto es una de las muestras de la naturaleza caótica e impredecible de este sistema

Vamos a hacer más zoom en los primeros segundos de simulación para ver como realmente empiezan a divergir las simulaciones.

![5 segundos de simulación](output (16).png)

Hasta el primer segundo de simulación las velocidades angulares son casi las mismas y la diferencia entre ellas es ínfima. A partir de ahí vemos como poco a poco empiezan a separarse hasta el segundo cinco cuando ya llevan velocidades muy distintas y la segunda simulación ya ha cambiado de dirección. Esta separación de las distintas velocidades angulares no ocurre progresivamente, sino que al principio empiezan a divergir muy lentamente y muy poco, pero a medida que va avanzando el tiempo de simulación lo van haciendo cada vez más rápido, ya que en los sistemas caóticos la sensibilidad a las condiciones iniciales hacen que los errores se vayan propagando de forma exponencial. Aunque en este sistema, al ser una simulación, no debería haber ninguna diferencia entre cada simulación en el momento inicial siempre existe una por muy pequeña que sea debido a la inexactitud de los ordenadores a partir de un número de decimales muy alto y en general a la imprecisión de los ordenadores a la hora de realizar todos los cálculos.

## Atractor

Sin embargo, hay un detalle de esta gráfica que no pasa desapercibido. Las velocidades angulares de las simulaciones se van separando cada vez más rápido, pero llegados a un punto sobre el segundo 7 dejan de separarse más y se quedan siempre en un rango entre los 0.2 a los 0.7 rad/s o los -0.2 y los -0.7 rad/s. Esto no es casualidad sino que estamos ante el atractor de este sistema.Esto significa que el estado de el sistema, aunque sea caótico, nunca va a salir de este rano de valores. Esto no solo lo presenta este sistema sino que como ya hemos visto está presente en muchos otros sistemas caóticas como la función logística o la famosa célula conectiva de Edward Lorenz.

Pero lo más interesante de este a atractor es que cambia entre dos estados diferentes, velocidad angular positiva y negativa. El sistema cambia de estado en los llamados "Tipping Points" en los cuales cualquier pequeña perturbación hace que llegue a cambiar todo el estado del sistema, que en este caso es la dirección del giro Esto también lo hace de manera totalmente caótica y como se puede ver en las cinco simulaciones algunas, en este caso la segundo simulación, tardan mucho menos tiempo que otras en hacerlo.

![5 segundos de simulación](phase_space_3d_iso_SW.png)

En esta gráfica se representa el atractor mediante tres ejes distintos que representan la posición vertical del centro de masas de las canicas, la posición horizontal del centro de masas de las canicas y la velocidad angular. El color de la línea representa el paso del tiempo yendo desde el principio en azul hasta al final en rojo.

![5 segundos de simulación](phase_space_3d_top.png)

Esta es otra vista del atractor en la misma simulación, pero esta vez visto desde arriba. En esta vista se aprecian perfectamente los dos estados que va tomando el sistema y como va cambiando entre cada uno.

Pero lo más interesante de este atractor es que es un atractor extraño, lo que significa que tiene una estructura fractal. Esto quiere decir que si hiciéramos zoom en dos líneas que parecieran tener el mismo recorrido, en realidad, no estarían pasando exactamente por los mismos valores sino que siempre tendrían una pequeña diferencia. Por muy iguales que parezcan dos valores del atractor siempre podríamos hacer zoom y descubrir que nunca pasan exactamente por el mismo sitio, es decir, la rueda nunca lleva dos veces los mismos valores de velocidad angular, posición en X y posición en Y al mismo tiempo.